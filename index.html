<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#2c3e50">
    
    <title>{{ $t('app.title') || 'MASKSERVICE C20 - System v3.0 Vue' }}</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://unpkg.com/vue@3/dist/vue.global.prod.js" as="script">
    <link rel="preload" href="/locales/pl.json" as="fetch" crossorigin>
    <link rel="preload" href="/locales/en.json" as="fetch" crossorigin>
    <link rel="preload" href="/locales/de.json" as="fetch" crossorigin>
    
    <!-- Vue.js 3 Production CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    
    <!-- Vue I18n for internationalization -->
    <script src="https://cdn.jsdelivr.net/npm/vue-i18n@9/dist/vue-i18n.global.prod.js"></script>
    
    <!-- CSS Stylesheets with cache busting -->
    <link rel="stylesheet" href="css/vue.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/lcd-optimization.css">
    
    <!-- App-specific styles -->
    <style>
        /* Critical CSS for initial load */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #f5f5f5;
            overflow-x: hidden;
        }
        
        #app {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Loading spinner */
        .app-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            flex-direction: column;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .loading-subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* Error state */
        .app-error {
            padding: 2rem;
            text-align: center;
            background: #fee;
            border: 1px solid #fcc;
            border-radius: 8px;
            margin: 2rem;
            color: #c33;
        }
        
        /* Mobile optimizations for 400x1280px display */
        @media (max-width: 450px) {
            .loading-text {
                font-size: 1rem;
            }
            
            .loading-subtitle {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
<div id="app">
    <!-- Loading state while Vue initializes -->
    <div class="app-loading" v-if="isLoading">
        <div class="loading-spinner"></div>
        <div class="loading-text">{{ $t('global.loading') || '≈Åadowanie...' }}</div>
        <div class="loading-subtitle">{{ $t('app.initializing') || 'Inicjalizacja systemu MASKSERVICE C20' }}</div>
    </div>
    
    <!-- Error state -->
    <div class="app-error" v-else-if="hasError">
        <h2>{{ $t('global.error') || 'B≈ÇƒÖd aplikacji' }}</h2>
        <p>{{ errorMessage }}</p>
        <button @click="retryInitialization" class="btn btn-primary">
            {{ $t('global.retry') || 'Spr√≥buj ponownie' }}
        </button>
    </div>
    
    <!-- Main Vue Application -->
    <MaskServiceApp 
        v-else
        @app-initialized="handleAppInitialized"
        @language-changed="handleLanguageChange"
        @menu-navigation="handleMenuNavigation"
    />
</div>

<!-- Vue.js Application Initialization Script -->
<script src="js/main.js" defer></script>
<script>
    // Cache buster for development
    console.log('‚ö° Cache buster: ' + Date.now());
</script>

<!-- Legacy content removed - now using js/main.js -->


            
            // Create i18n instance
            const i18n = createI18n({
                locale: localStorage.getItem('app-language') || 'pl',
                fallbackLocale: 'en',
                messages,
                legacy: false,
                globalInjection: true
            });
            
            // Create Vue app
            const app = createApp({
                name: 'MaskServiceVueApp',
                data() {
                    return {
                        // === MAIN APP CONFIGURATION ===
                        
                        // Application state
                        isLoading: true,
                        hasError: false,
                        errorMessage: '',
                        
                        // Navigation state
                        currentRoute: null,
                        navigationHistory: [],
                        
                        // User session
                        currentUser: null,
                        sessionTimeout: null,
                        
                        // Application metadata
                        APP_NAME: 'MASKSERVICE C20',
                        APP_VERSION: '3.0 Vue',
                        BUILD_DATE: new Date().toISOString().split('T')[0],
                        
                        // Performance monitoring
                        initStartTime: performance.now(),
                        componentLoadTimes: {},
                        
                        // Feature flags
                        FEATURES: {
                            PRESSURE_SIMULATION: true,
                            VIRTUAL_KEYBOARD: true,
                            OFFLINE_MODE: false,
                            DEBUG_MODE: false
                        }
                    }
                },
                
                async mounted() {
                    console.log('üöÄ Vue App mounting...');
                    
                    try {
                        // Initialize app components
                        await this.initializeComponents();
                        
                        // Setup event listeners
                        this.setupEventListeners();
                        
                        // Check for saved session
                        this.restoreSession();
                        
                        // Mark as loaded
                        this.isLoading = false;
                        
                        const loadTime = performance.now() - this.initStartTime;
                        console.log(`‚úÖ Vue App initialized in ${loadTime.toFixed(2)}ms`);
                        
                    } catch (error) {
                        console.error('‚ùå App initialization failed:', error);
                        this.hasError = true;
                        this.errorMessage = error.message || 'Unknown initialization error';
                        this.isLoading = false;
                    }
                },
                
                methods: {
                    async initializeComponents() {
                        // Static component registration to avoid MIME type issues
                        const componentStartTime = performance.now();
                        
                        try {
                            // Register MaskServiceApp component directly on the Vue app instance
                            const MaskServiceAppComponent = {
                                name: 'MaskServiceApp',
                                template: `
                                    <div class="mask-service-container">
                                        <!-- Header -->
                                        <header class="app-header">
                                            <div class="header-left">
                                                <span class="logo">{{ $t('app.title') || 'MASKSERVICE' }}</span>
                                                <span class="version">{{ APP_VERSION }}</span>
                                            </div>
                                            <div class="header-center">
                                                <span class="device-status" :class="deviceStatusClass">
                                                    {{ $t(deviceStatusKey) || deviceStatus }}
                                                </span>
                                            </div>
                                            <div class="header-right">
                                                <div class="language-switcher">
                                                    <button 
                                                        v-for="lang in availableLanguages" 
                                                        :key="lang.code"
                                                        @click="changeLanguage(lang.code)"
                                                        :class="['lang-btn', { active: currentLanguage === lang.code }]"
                                                        :title="lang.name"
                                                    >
                                                        {{ lang.flag }}
                                                    </button>
                                                </div>
                                            </div>
                                        </header>
                                        
                                        <!-- Main Content -->
                                        <main class="main-content">
                                            <!-- Login Screen -->
                                            <div v-if="!currentUser" class="login-screen">
                                                <div class="login-container">
                                                    <h2>{{ $t('login.title') || 'Logowanie' }}</h2>
                                                    
                                                    <!-- Login Method Selector -->
                                                    <div class="login-methods">
                                                        <button 
                                                            v-for="method in loginMethods" 
                                                            :key="method.id"
                                                            @click="selectLoginMethod(method.id)"
                                                            :class="['method-btn', { active: selectedLoginMethod === method.id }]"
                                                        >
                                                            {{ $t(method.labelKey) || method.label }}
                                                        </button>
                                                    </div>
                                                    
                                                    <!-- Role Login Buttons -->
                                                    <div class="role-login-buttons">
                                                        <div v-for="role in availableRoles" :key="role.id" class="role-container">
                                                            <button 
                                                                @click="toggleRoleMenu(role.id)"
                                                                :class="['role-btn', role.cssClass]"
                                                            >
                                                                {{ $t(role.labelKey) || role.label }}
                                                            </button>
                                                            
                                                            <!-- Role Menu Accordion -->
                                                            <div 
                                                                v-if="expandedRole === role.id" 
                                                                class="role-menu-accordion"
                                                            >
                                                                <div 
                                                                    v-for="menuItem in role.menuItems" 
                                                                    :key="menuItem.id"
                                                                    @click="loginWithRole(role.id, menuItem)"
                                                                    class="menu-item"
                                                                >
                                                                    <span class="menu-icon">{{ menuItem.icon }}</span>
                                                                    <span class="menu-label">{{ $t(menuItem.labelKey) || menuItem.label }}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- User Menu Screen -->
                                            <div v-else class="user-menu-screen">
                                                <div class="menu-header">
                                                    <h2>{{ $t('menu.welcome') || 'Menu g≈Ç√≥wne' }}</h2>
                                                    <div class="user-info">
                                                        <span class="user-role">{{ currentUser.role }}</span>
                                                        <button @click="logout" class="logout-btn">
                                                            {{ $t('user.logout') || 'Wyloguj' }}
                                                        </button>
                                                    </div>
                                                </div>
                                                
                                                <div class="menu-grid">
                                                    <div 
                                                        v-for="menuItem in currentUserMenuItems" 
                                                        :key="menuItem.id"
                                                        @click="selectMenuItem(menuItem)"
                                                        class="menu-card"
                                                    >
                                                        <div class="card-icon">{{ menuItem.icon }}</div>
                                                        <div class="card-title">{{ $t(menuItem.labelKey) || menuItem.label }}</div>
                                                        <div class="card-description">{{ $t(menuItem.descriptionKey) || menuItem.description }}</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </main>
                                        
                                        <!-- Pressure Panel -->
                                        <div v-if="showPressurePanel" class="pressure-panel">
                                            <h3>{{ $t('pressure.title') || 'Panel Ci≈õnie≈Ñ' }}</h3>
                                            <div class="pressure-grid">
                                                <div 
                                                    v-for="(data, type) in pressureData" 
                                                    :key="type"
                                                    :class="['pressure-item', type]"
                                                >
                                                    <div class="pressure-label">{{ $t('pressure.' + type) || type }}</div>
                                                    <div class="pressure-value">{{ data.value }} {{ data.unit }}</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Footer -->
                                        <footer class="app-footer">
                                            <div class="footer-left">
                                                <span class="device-info">{{ deviceInfo.name }} - {{ deviceInfo.type }}</span>
                                            </div>
                                            <div class="footer-right">
                                                <span class="current-time">{{ currentTime }}</span>
                                            </div>
                                        </footer>
                                    </div>
                                `,
                                data() {
                                    return {
                                        // === COMPONENT CONFIGURATION ===
                                        APP_VERSION: '3.0 Vue',
                                        
                                        // Device status
                                        deviceStatus: 'OFFLINE',
                                        deviceInfo: {
                                            name: 'MASKSERVICE C20',
                                            type: '1001'
                                        },
                                        
                                        // User management
                                        currentUser: null,
                                        expandedRole: null,
                                        selectedLoginMethod: 'keyword',
                                        
                                        // Language management
                                        currentLanguage: 'pl',
                                        availableLanguages: [
                                            { code: 'pl', name: 'Polski', flag: 'üáµüá±' },
                                            { code: 'en', name: 'English', flag: 'üá¨üáß' },
                                            { code: 'de', name: 'Deutsch', flag: 'üá©üá™' }
                                        ],
                                        
                                        // Login configuration
                                        loginMethods: [
                                            { id: 'scanner', labelKey: 'login.scanner', label: 'Scanner' },
                                            { id: 'keyword', labelKey: 'login.keyword', label: 'Keyword' }
                                        ],
                                        
                                        // Role configuration
                                        availableRoles: [
                                            {
                                                id: 'OPERATOR',
                                                labelKey: 'roles.OPERATOR',
                                                label: 'Login as OPERATOR',
                                                cssClass: 'btn-operator',
                                                menuItems: [
                                                    { id: 'test_wizard', icon: 'üßô', labelKey: 'menu.test_wizard', label: 'Test Wizard' },
                                                    { id: 'quick_test', icon: '‚ö°', labelKey: 'menu.quick_test', label: 'Quick Test' },
                                                    { id: 'test_scenarios', icon: 'üìã', labelKey: 'menu.test_scenarios', label: 'Test Scenarios' },
                                                    { id: 'device_history', icon: 'üìà', labelKey: 'menu.device_history', label: 'Device History' },
                                                    { id: 'reports_view', icon: 'üìÑ', labelKey: 'menu.reports_view', label: 'View Reports' }
                                                ]
                                            },
                                            {
                                                id: 'ADMIN',
                                                labelKey: 'roles.ADMIN',
                                                label: 'Login as ADMIN',
                                                cssClass: 'btn-admin',
                                                menuItems: [
                                                    { id: 'reports_batch', icon: 'üìä', labelKey: 'menu.reports_batch', label: 'Batch Reports' },
                                                    { id: 'reports_schedule', icon: '‚è∞', labelKey: 'menu.reports_schedule', label: 'Schedule Reports' },
                                                    { id: 'users_management', icon: 'üë•', labelKey: 'menu.users_management', label: 'Users Management' },
                                                    { id: 'system_settings', icon: '‚öôÔ∏è', labelKey: 'menu.system_settings', label: 'System Settings' }
                                                ]
                                            },
                                            {
                                                id: 'SERVICEUSER',
                                                labelKey: 'roles.SERVICEUSER',
                                                label: 'Login as SERVICEUSER',
                                                cssClass: 'btn-service',
                                                menuItems: [
                                                    { id: 'workshop_inventory', icon: 'üì¶', labelKey: 'menu.workshop_inventory', label: 'Workshop Inventory' },
                                                    { id: 'workshop_maintenance', icon: 'üîß', labelKey: 'menu.workshop_maintenance', label: 'Maintenance' },
                                                    { id: 'workshop_parts', icon: '‚öôÔ∏è', labelKey: 'menu.workshop_parts', label: 'Parts Management' },
                                                    { id: 'workshop_tools', icon: 'üõ†Ô∏è', labelKey: 'menu.workshop_tools', label: 'Tools Management' },
                                                    { id: 'device_diagnostics', icon: 'üîç', labelKey: 'menu.device_diagnostics', label: 'Device Diagnostics' }
                                                ]
                                            },
                                            {
                                                id: 'SUPERUSER',
                                                labelKey: 'roles.SUPERUSER',
                                                label: 'Login as SUPERUSER',
                                                cssClass: 'btn-super',
                                                menuItems: [
                                                    { id: 'system_config', icon: 'üîß', labelKey: 'menu.system_config', label: 'System Config' },
                                                    { id: 'advanced_diagnostics', icon: 'üî¨', labelKey: 'menu.advanced_diagnostics', label: 'Advanced Diagnostics' },
                                                    { id: 'security_settings', icon: 'üîê', labelKey: 'menu.security_settings', label: 'Security Settings' },
                                                    { id: 'backup_restore', icon: 'üíæ', labelKey: 'menu.backup_restore', label: 'Backup & Restore' }
                                                ]
                                            }
                                        ],
                                        
                                        // Pressure simulation data
                                        pressureData: {
                                            low: { value: 10, unit: 'mbar' },
                                            medium: { value: 20, unit: 'bar' },
                                            high: { value: 30, unit: 'bar' }
                                        },
                                        
                                        // Time display
                                        currentTime: new Date().toLocaleTimeString()
                                    }
                                },
                                computed: {
                                    deviceStatusClass() {
                                        return `status-${this.deviceStatus.toLowerCase()}`;
                                    },
                                    deviceStatusKey() {
                                        return `device.${this.deviceStatus.toLowerCase()}`;
                                    },
                                    showPressurePanel() {
                                        return this.currentUser && ['OPERATOR', 'SERVICEUSER'].includes(this.currentUser.role);
                                    },
                                    currentUserMenuItems() {
                                        if (!this.currentUser) return [];
                                        const role = this.availableRoles.find(r => r.id === this.currentUser.role);
                                        return role ? role.menuItems : [];
                                    }
                                },
                                methods: {
                                    selectLoginMethod(methodId) {
                                        this.selectedLoginMethod = methodId;
                                        console.log(`üîë Selected login method: ${methodId}`);
                                    },
                                    
                                    toggleRoleMenu(roleId) {
                                        this.expandedRole = this.expandedRole === roleId ? null : roleId;
                                        console.log(`üìÇ Toggled role menu: ${roleId}`);
                                    },
                                    
                                    loginWithRole(roleId, menuItem) {
                                        this.currentUser = { role: roleId, selectedMenuItem: menuItem };
                                        this.deviceStatus = 'ONLINE';
                                        this.expandedRole = null;
                                        console.log(`‚úÖ Logged in as ${roleId} with menu item:`, menuItem);
                                    },
                                    
                                    logout() {
                                        this.currentUser = null;
                                        this.deviceStatus = 'OFFLINE';
                                        this.expandedRole = null;
                                        console.log('üëã User logged out');
                                    },
                                    
                                    selectMenuItem(menuItem) {
                                        console.log(`üéØ Selected menu item:`, menuItem);
                                        // Emit to parent or handle navigation
                                        this.$emit('menu-navigation', menuItem);
                                    },
                                    
                                    changeLanguage(languageCode) {
                                        this.currentLanguage = languageCode;
                                        this.$emit('language-changed', languageCode);
                                        console.log(`üåê Language changed to: ${languageCode}`);
                                    },
                                    
                                    updateTime() {
                                        this.currentTime = new Date().toLocaleTimeString();
                                    }
                                },
                                mounted() {
                                    // Update time every second
                                    this.timeInterval = setInterval(this.updateTime, 1000);
                                    console.log('üöÄ MaskServiceApp component mounted');
                                },
                                beforeUnmount() {
                                    if (this.timeInterval) {
                                        clearInterval(this.timeInterval);
                                    }
                                }
                            };
                            
                            // Register component on the Vue app instance  
                            if (window.vueApp) {
                                window.vueApp.component('MaskServiceApp', MaskServiceAppComponent);
                            } else {
                                // Store for later registration when app is available
                                window.pendingMaskServiceApp = MaskServiceAppComponent;
                            }
                            
                            this.componentLoadTimes.MaskServiceApp = performance.now() - componentStartTime;
                            console.log('üì¶ MaskServiceApp component registered statically');
                            
                        } catch (error) {
                            console.error('Component registration failed:', error);
                            throw new Error('Failed to register main application component');
                        }
                    },
                    
                    setupEventListeners() {
                        // Global error handler
                        window.addEventListener('error', (event) => {
                            console.error('Global error:', event.error);
                            this.handleGlobalError(event.error);
                        });
                        
                        // Unhandled promise rejection handler
                        window.addEventListener('unhandledrejection', (event) => {
                            console.error('Unhandled promise rejection:', event.reason);
                            this.handleGlobalError(new Error(event.reason));
                        });
                        
                        // Visibility change handler
                        document.addEventListener('visibilitychange', () => {
                            if (document.hidden) {
                                console.log('üì± App went to background');
                            } else {
                                console.log('üì± App came to foreground');
                            }
                        });
                        
                        // Keyboard shortcuts
                        document.addEventListener('keydown', (event) => {
                            if (event.ctrlKey || event.metaKey) {
                                switch (event.key) {
                                    case 'r':
                                        if (event.shiftKey) {
                                            event.preventDefault();
                                            this.retryInitialization();
                                        }
                                        break;
                                    case 'l':
                                        if (event.shiftKey) {
                                            event.preventDefault();
                                            this.toggleLanguage();
                                        }
                                        break;
                                }
                            }
                        });
                    },
                    
                    restoreSession() {
                        try {
                            const savedSession = localStorage.getItem('maskservice-session');
                            if (savedSession) {
                                const sessionData = JSON.parse(savedSession);
                                if (sessionData.expiresAt > Date.now()) {
                                    this.currentUser = sessionData.user;
                                    console.log('üîÑ Session restored:', sessionData.user.role);
                                } else {
                                    localStorage.removeItem('maskservice-session');
                                    console.log('‚è∞ Expired session removed');
                                }
                            }
                        } catch (error) {
                            console.error('Session restoration failed:', error);
                            localStorage.removeItem('maskservice-session');
                        }
                    },
                    
                    handleAppInitialized() {
                        console.log('‚úÖ Main app component initialized');
                        this.$emit('app-ready');
                    },
                    
                    handleLanguageChange(newLanguage) {
                        this.$i18n.locale = newLanguage;
                        localStorage.setItem('app-language', newLanguage);
                        document.documentElement.lang = newLanguage;
                        console.log(`üåê Language changed to: ${newLanguage}`);
                    },
                    
                    handleMenuNavigation(navigationData) {
                        this.navigationHistory.push({
                            ...navigationData,
                            timestamp: new Date().toISOString()
                        });
                        console.log('üìÇ Menu navigation:', navigationData);
                    },
                    
                    handleGlobalError(error) {
                        if (!this.hasError) {
                            this.hasError = true;
                            this.errorMessage = error.message || 'Unknown error occurred';
                            this.isLoading = false;
                        }
                    },
                    
                    retryInitialization() {
                        console.log('üîÑ Retrying initialization...');
                        this.hasError = false;
                        this.errorMessage = '';
                        this.isLoading = true;
                        this.initStartTime = performance.now();
                        
                        // Retry after brief delay
                        setTimeout(() => {
                            this.initializeComponents().then(() => {
                                this.isLoading = false;
                            }).catch((error) => {
                                this.handleGlobalError(error);
                            });
                        }, 500);
                    },
                    
                    toggleLanguage() {
                        const languages = ['pl', 'en', 'de'];
                        const currentIndex = languages.indexOf(this.$i18n.locale);
                        const nextIndex = (currentIndex + 1) % languages.length;
                        this.handleLanguageChange(languages[nextIndex]);
                    }
                }
            });
            
            // Use i18n
            app.use(i18n);
            
            // Register MaskServiceApp component before mounting
            app.component('MaskServiceApp', {
                name: 'MaskServiceApp',
                template: `
                    <div class="mask-service-container">
                        <!-- Header -->
                        <header class="app-header">
                            <div class="header-left">
                                <span class="logo">{{ $t('app.title') || 'MASKSERVICE' }}</span>
                                <span class="version">3.0 Vue</span>
                            </div>
                            <div class="header-center">
                                <span class="device-status" :class="deviceStatusClass">
                                    {{ $t(deviceStatusKey) || deviceStatus }}
                                </span>
                            </div>
                            <div class="header-right">
                                <div class="language-switcher">
                                    <button 
                                        v-for="lang in availableLanguages" 
                                        :key="lang.code"
                                        @click="changeLanguage(lang.code)"
                                        :class="['lang-btn', { active: currentLanguage === lang.code }]"
                                        :title="lang.name"
                                    >
                                        {{ lang.flag }}
                                    </button>
                                </div>
                            </div>
                        </header>
                        
                        <!-- Main Content -->
                        <main class="main-content">
                            <!-- Login Screen -->
                            <div v-if="!currentUser" class="login-screen">
                                <div class="login-container">
                                    <h2>{{ $t('login.title') || 'Logowanie' }}</h2>
                                    
                                    <!-- Role Login Buttons -->
                                    <div class="role-login-buttons">
                                        <div v-for="role in availableRoles" :key="role.id" class="role-container">
                                            <button 
                                                @click="toggleRoleMenu(role.id)"
                                                :class="['role-btn', role.cssClass]"
                                            >
                                                {{ $t(role.labelKey) || role.label }}
                                            </button>
                                            
                                            <!-- Role Menu Accordion -->
                                            <div 
                                                v-if="expandedRole === role.id" 
                                                class="role-menu-accordion"
                                            >
                                                <div 
                                                    v-for="menuItem in role.menuItems" 
                                                    :key="menuItem.id"
                                                    @click="loginWithRole(role.id, menuItem)"
                                                    class="menu-item"
                                                >
                                                    <span class="menu-icon">{{ menuItem.icon }}</span>
                                                    <span class="menu-label">{{ $t(menuItem.labelKey) || menuItem.label }}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- User Menu Screen -->
                            <div v-else class="user-menu-screen">
                                <div class="menu-header">
                                    <h2>{{ $t('menu.welcome') || 'Menu g≈Ç√≥wne' }}</h2>
                                    <div class="user-info">
                                        <span class="user-role">{{ currentUser.role }}</span>
                                        <button @click="logout" class="logout-btn">
                                            {{ $t('user.logout') || 'Wyloguj' }}
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="menu-grid">
                                    <div 
                                        v-for="menuItem in currentUserMenuItems" 
                                        :key="menuItem.id"
                                        @click="selectMenuItem(menuItem)"
                                        class="menu-card"
                                    >
                                        <div class="card-icon">{{ menuItem.icon }}</div>
                                        <div class="card-title">{{ $t(menuItem.labelKey) || menuItem.label }}</div>
                                        <div class="card-description">{{ $t(menuItem.descriptionKey) || menuItem.description }}</div>
                                    </div>
                                </div>
                            </div>
                        </main>
                        
                        <!-- Pressure Panel -->
                        <div v-if="showPressurePanel" class="pressure-panel">
                            <h3>{{ $t('pressure.title') || 'Panel Ci≈õnie≈Ñ' }}</h3>
                            <div class="pressure-grid">
                                <div 
                                    v-for="(data, type) in pressureData" 
                                    :key="type"
                                    :class="['pressure-item', type]"
                                >
                                    <div class="pressure-label">{{ $t('pressure.' + type) || type }}</div>
                                    <div class="pressure-value">{{ data.value }} {{ data.unit }}</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Footer -->
                        <footer class="app-footer">
                            <div class="footer-left">
                                <span class="device-info">MASKSERVICE C20 - 1001</span>
                            </div>
                            <div class="footer-right">
                                <span class="current-time">{{ currentTime }}</span>
                            </div>
                        </footer>
                    </div>
                `,
                data() {
                    return {
                        // Device status
                        deviceStatus: 'OFFLINE',
                        
                        // User management
                        currentUser: null,
                        expandedRole: null,
                        
                        // Language management
                        currentLanguage: 'pl',
                        availableLanguages: [
                            { code: 'pl', name: 'Polski', flag: 'üáµüá±' },
                            { code: 'en', name: 'English', flag: 'üá¨üáß' },
                            { code: 'de', name: 'Deutsch', flag: 'üá©üá™' }
                        ],
                        
                        // Role configuration
                        availableRoles: [
                            {
                                id: 'OPERATOR',
                                labelKey: 'roles.OPERATOR',
                                label: 'Login as OPERATOR',
                                cssClass: 'btn-operator',
                                menuItems: [
                                    { id: 'test_wizard', icon: 'üßô', labelKey: 'menu.test_wizard', label: 'Test Wizard' },
                                    { id: 'quick_test', icon: '‚ö°', labelKey: 'menu.quick_test', label: 'Quick Test' }
                                ]
                            },
                            {
                                id: 'ADMIN',
                                labelKey: 'roles.ADMIN',
                                label: 'Login as ADMIN',
                                cssClass: 'btn-admin',
                                menuItems: [
                                    { id: 'reports_batch', icon: 'üìä', labelKey: 'menu.reports_batch', label: 'Batch Reports' },
                                    { id: 'users_management', icon: 'üë•', labelKey: 'menu.users_management', label: 'Users Management' }
                                ]
                            },
                            {
                                id: 'SERVICEUSER',
                                labelKey: 'roles.SERVICEUSER',
                                label: 'Login as SERVICEUSER',
                                cssClass: 'btn-service',
                                menuItems: [
                                    { id: 'workshop_maintenance', icon: 'üîß', labelKey: 'menu.workshop_maintenance', label: 'Maintenance' },
                                    { id: 'device_diagnostics', icon: 'üîç', labelKey: 'menu.device_diagnostics', label: 'Device Diagnostics' }
                                ]
                            }
                        ],
                        
                        // Pressure simulation data
                        pressureData: {
                            low: { value: 10, unit: 'mbar' },
                            medium: { value: 20, unit: 'bar' },
                            high: { value: 30, unit: 'bar' }
                        },
                        
                        // Time display
                        currentTime: new Date().toLocaleTimeString()
                    }
                },
                computed: {
                    deviceStatusClass() {
                        return `status-${this.deviceStatus.toLowerCase()}`;
                    },
                    deviceStatusKey() {
                        return `device.${this.deviceStatus.toLowerCase()}`;
                    },
                    showPressurePanel() {
                        return this.currentUser && ['OPERATOR', 'SERVICEUSER'].includes(this.currentUser.role);
                    },
                    currentUserMenuItems() {
                        if (!this.currentUser) return [];
                        const role = this.availableRoles.find(r => r.id === this.currentUser.role);
                        return role ? role.menuItems : [];
                    }
                },
                methods: {
                    toggleRoleMenu(roleId) {
                        this.expandedRole = this.expandedRole === roleId ? null : roleId;
                        console.log(`üìÇ Toggled role menu: ${roleId}`);
                    },
                    
                    loginWithRole(roleId, menuItem) {
                        this.currentUser = { role: roleId, selectedMenuItem: menuItem };
                        this.deviceStatus = 'ONLINE';
                        this.expandedRole = null;
                        console.log(`‚úÖ Logged in as ${roleId} with menu item:`, menuItem);
                    },
                    
                    logout() {
                        this.currentUser = null;
                        this.deviceStatus = 'OFFLINE';
                        this.expandedRole = null;
                        console.log('üëã User logged out');
                    },
                    
                    selectMenuItem(menuItem) {
                        console.log(`üéØ Selected menu item:`, menuItem);
                        this.$emit('menu-navigation', menuItem);
                    },
                    
                    changeLanguage(languageCode) {
                        this.currentLanguage = languageCode;
                        this.$emit('language-changed', languageCode);
                        console.log(`üåê Language changed to: ${languageCode}`);
                    },
                    
                    updateTime() {
                        this.currentTime = new Date().toLocaleTimeString();
                    }
                },
                mounted() {
                    // Update time every second
                    this.timeInterval = setInterval(this.updateTime, 1000);
                    console.log('üöÄ MaskServiceApp component mounted');
                },
                beforeUnmount() {
                    if (this.timeInterval) {
                        clearInterval(this.timeInterval);
                    }
                }
            });
            
            console.log('üì¶ MaskServiceApp component registered on Vue app instance');
            
            // Global error handler for Vue
            app.config.errorHandler = (error, instance, info) => {
                console.error('Vue error:', error, info);
            };
            
            // Mount the app
            const mountedApp = app.mount('#app');
            
            // Global app reference
            window.MaskServiceVueApp = mountedApp;
            
            console.log('üéØ Vue.js App successfully initialized!');
            
        } catch (error) {
            console.error('‚ùå Critical initialization error:', error);
            
            // Fallback error display
            document.getElementById('app').innerHTML = `
                <div class="app-error">
                    <h2>B≈ÇƒÖd inicjalizacji aplikacji / Application Initialization Error</h2>
                    <p><strong>Error:</strong> ${error.message}</p>
                    <p>Please refresh the page or contact support.</p>
                    <button onclick="window.location.reload()" class="btn btn-primary">
                        Od≈õwie≈º stronƒô / Refresh Page
                    </button>
                </div>
            `;
        }
    }
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeApp);
    } else {
        initializeApp();
    }
    
    // Performance monitoring
    window.addEventListener('load', () => {
        const loadTime = performance.now();
        console.log(`üìä Page fully loaded in ${loadTime.toFixed(2)}ms`);
    });
    
</script>

</body>
</html>
                            <!-- OPERATOR Role -->
                            <div class="role-menu-container">
                                <button id="login-operator-btn" class="menu-item btn-gray login-btn"
                                        onclick="toggleRoleMenu('OPERATOR'); mockLoginWithMenu('OPERATOR')">
                                    Login as OPERATOR
                                </button>
                                <div id="operator-menu" class="menu-sidebar-extended role-menu-collapsed">
                                    <div class="extended-menu-item" onclick="selectMenuOption('test_wizard')">
                                        <span class="extended-menu-icon">üßô</span>
                                        <span class="extended-menu-label">Test Wizard</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('test_quick')">
                                        <span class="extended-menu-icon">‚ö°</span>
                                        <span class="extended-menu-label">Quick Test</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('device_history')">
                                        <span class="extended-menu-icon">üìú</span>
                                        <span class="extended-menu-label">Device History</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('reports_view')">
                                        <span class="extended-menu-icon">üìÑ</span>
                                        <span class="extended-menu-label">View Reports</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ADMIN Role -->
                            <div class="role-menu-container">
                                <button id="login-admin-btn" class="menu-item btn-green login-btn"
                                        onclick="toggleRoleMenu('ADMIN'); mockLoginWithMenu('ADMIN')">
                                    Login as ADMIN
                                </button>
                                <div id="admin-menu" class="menu-sidebar-extended role-menu-collapsed">
                                    <div class="extended-menu-item" onclick="selectMenuOption('test_wizard')">
                                        <span class="extended-menu-icon">üßô</span>
                                        <span class="extended-menu-label">Test Wizard</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('test_scenarios')">
                                        <span class="extended-menu-icon">üìã</span>
                                        <span class="extended-menu-label">Test Scenarios</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('reports_batch')">
                                        <span class="extended-menu-icon">üìä</span>
                                        <span class="extended-menu-label">Batch Reports</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('reports_schedule')">
                                        <span class="extended-menu-icon">‚è∞</span>
                                        <span class="extended-menu-label">Report Schedule</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('users_management')">
                                        <span class="extended-menu-icon">üë•</span>
                                        <span class="extended-menu-label">User Management</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('settings_system')">
                                        <span class="extended-menu-icon">‚öôÔ∏è</span>
                                        <span class="extended-menu-label">System Settings</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- SERVICEUSER Role -->
                            <div class="role-menu-container">
                                <button id="login-serviceuser-btn" class="menu-item btn-yellow login-btn"
                                        onclick="toggleRoleMenu('SERVICEUSER'); mockLoginWithMenu('SERVICEUSER')">
                                    Login as SERVICEUSER
                                </button>
                                <div id="serviceuser-menu" class="menu-sidebar-extended role-menu-collapsed">
                                    <div class="extended-menu-item" onclick="selectMenuOption('workshop_inventory')">
                                        <span class="extended-menu-icon">üì¶</span>
                                        <span class="extended-menu-label">Workshop Inventory</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('workshop_maintenance')">
                                        <span class="extended-menu-icon">üîß</span>
                                        <span class="extended-menu-label">Maintenance</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('workshop_parts')">
                                        <span class="extended-menu-icon">üõ†Ô∏è</span>
                                        <span class="extended-menu-label">Spare Parts</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('workshop_tools')">
                                        <span class="extended-menu-icon">üî®</span>
                                        <span class="extended-menu-label">Calibration Tools</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('device_diagnostics')">
                                        <span class="extended-menu-icon">üîç</span>
                                        <span class="extended-menu-label">Device Diagnostics</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- SUPERUSER Role -->
                            <div class="role-menu-container">
                                <button id="login-superuser-btn" class="menu-item btn-red login-btn"
                                        onclick="toggleRoleMenu('SUPERUSER'); mockLoginWithMenu('SUPERUSER')">
                                    Login as SUPERUSER
                                </button>
                                <div id="superuser-menu" class="menu-sidebar-extended role-menu-collapsed">
                                    <div class="extended-menu-item" onclick="selectMenuOption('system_config')">
                                        <span class="extended-menu-icon">üîß</span>
                                        <span class="extended-menu-label">System Configuration</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('advanced_diagnostics')">
                                        <span class="extended-menu-icon">üî¨</span>
                                        <span class="extended-menu-label">Advanced Diagnostics</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('security_settings')">
                                        <span class="extended-menu-icon">üîê</span>
                                        <span class="extended-menu-label">Security Settings</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('backup_restore')">
                                        <span class="extended-menu-icon">üíæ</span>
                                        <span class="extended-menu-label">Backup & Restore</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('audit_logs')">
                                        <span class="extended-menu-icon">üìã</span>
                                        <span class="extended-menu-label">Audit Logs</span>
                                    </div>
                                    <div class="extended-menu-item" onclick="selectMenuOption('network_config')">
                                        <span class="extended-menu-icon">üåê</span>
                                        <span class="extended-menu-label">Network Configuration</span>
                                    </div>
                                </div>
                            </div>
                        </span>

                    </div>
                    <div class="menu-content">
                        <div id="login-keyword" class="login-method active">
                            <h2 data-i18n="login.user_login_by_keyword">User Login By Keyword</h2>
                            <div class="login-form">
                                <div class="password-container">
                                    <input type="password" id="password-input" placeholder="Password"
                                           data-i18n-placeholder="login.password_placeholder"
                                           readonly="readonly"
                                           inputmode="none"
                                           autocomplete="off"
                                           onclick="this.focus()"
                                           onfocus="this.removeAttribute('readonly')">
                                    <span class="toggle-password" onclick="togglePasswordVisibility()">üëÅÔ∏è</span>
                                </div>
                                <div class="keyboard-container">
                                    <div class="virtual-keyboard" id="virtual-keyboard">
                                        <!-- Row 1 -->
                                        <div class="keyboard-row">
                                            <div id="key-1" class="keyboard-key" data-char="1" data-shift-char="!">
                                                1<span class="sub-char">!</span></div>
                                            <div id="key-2" class="keyboard-key" data-char="2" data-shift-char="@">
                                                2<span class="sub-char">@</span></div>
                                            <div id="key-3" class="keyboard-key" data-char="3" data-shift-char="#">
                                                3<span class="sub-char">#</span></div>
                                            <div id="key-4" class="keyboard-key" data-char="4" data-shift-char="$">
                                                4<span class="sub-char">$</span></div>
                                            <div id="key-5" class="keyboard-key" data-char="5" data-shift-char="%">
                                                5<span class="sub-char">%</span></div>
                                            <div id="key-6" class="keyboard-key" data-char="6" data-shift-char="^">
                                                6<span class="sub-char">^</span></div>
                                            <div id="key-7" class="keyboard-key" data-char="7" data-shift-char="&">
                                                7<span class="sub-char">&</span></div>
                                            <div id="key-8" class="keyboard-key" data-char="8" data-shift-char="*">
                                                8<span class="sub-char">*</span></div>
                                            <div id="key-9" class="keyboard-key" data-char="9" data-shift-char="(">
                                                9<span class="sub-char">(</span></div>
                                            <div id="key-0" class="keyboard-key" data-char="0" data-shift-char=")">
                                                0<span class="sub-char">)</span></div>
                                            <div id="key-backspace" class="keyboard-key special backspace"
                                                 data-action="backspace">‚å´
                                            </div>
                                        </div>
                                        <!-- Row 2 -->
                                        <div class="keyboard-row">
                                            <div id="key-q" class="keyboard-key" data-char="q" data-shift-char="Q">q
                                            </div>
                                            <div id="key-w" class="keyboard-key" data-char="w" data-shift-char="W">w
                                            </div>
                                            <div id="key-e" class="keyboard-key" data-char="e" data-shift-char="E">e
                                            </div>
                                            <div id="key-r" class="keyboard-key" data-char="r" data-shift-char="R">r
                                            </div>
                                            <div id="key-t" class="keyboard-key" data-char="t" data-shift-char="T">t
                                            </div>
                                            <div id="key-y" class="keyboard-key" data-char="y" data-shift-char="Y">y
                                            </div>
                                            <div id="key-u" class="keyboard-key" data-char="u" data-shift-char="U">u
                                            </div>
                                            <div id="key-i" class="keyboard-key" data-char="i" data-shift-char="I">i
                                            </div>
                                            <div id="key-o" class="keyboard-key" data-char="o" data-shift-char="O">o
                                            </div>
                                            <div id="key-p" class="keyboard-key" data-char="p" data-shift-char="P">p
                                            </div>
                                        </div>
                                        <!-- Row 3 -->
                                        <div class="keyboard-row">
                                            <div id="key-caps" class="keyboard-key special caps" data-action="caps"
                                                 data-i18n="keyboard.caps">Caps
                                            </div>
                                            <div id="key-a" class="keyboard-key" data-char="a" data-shift-char="A">a
                                            </div>
                                            <div id="key-s" class="keyboard-key" data-char="s" data-shift-char="S">s
                                            </div>
                                            <div id="key-d" class="keyboard-key" data-char="d" data-shift-char="D">d
                                            </div>
                                            <div id="key-f" class="keyboard-key" data-char="f" data-shift-char="F">f
                                            </div>
                                            <div id="key-g" class="keyboard-key" data-char="g" data-shift-char="G">g
                                            </div>
                                            <div id="key-h" class="keyboard-key" data-char="h" data-shift-char="H">h
                                            </div>
                                            <div id="key-j" class="keyboard-key" data-char="j" data-shift-char="J">j
                                            </div>
                                            <div id="key-k" class="keyboard-key" data-char="k" data-shift-char="K">k
                                            </div>
                                            <div id="key-l" class="keyboard-key" data-char="l" data-shift-char="L">l
                                            </div>
                                            <div id="key-enter" class="keyboard-key special enter" data-action="enter"
                                                 title="Enter">‚èé
                                            </div>
                                        </div>
                                        <!-- Row 4 -->
                                        <div class="keyboard-row">
                                            <div id="key-shift" class="keyboard-key special shift" data-action="shift">
                                                ‚áß
                                            </div>
                                            <div id="key-z" class="keyboard-key" data-char="z" data-shift-char="Z">z
                                            </div>
                                            <div id="key-x" class="keyboard-key" data-char="x" data-shift-char="X">x
                                            </div>
                                            <div id="key-c" class="keyboard-key" data-char="c" data-shift-char="C">c
                                            </div>
                                            <div id="key-v" class="keyboard-key" data-char="v" data-shift-char="V">v
                                            </div>
                                            <div id="key-b" class="keyboard-key" data-char="b" data-shift-char="B">b
                                            </div>
                                            <div id="key-n" class="keyboard-key" data-char="n" data-shift-char="N">n
                                            </div>
                                            <div id="key-m" class="keyboard-key" data-char="m" data-shift-char="M">m
                                            </div>
                                            <div id="key-comma" class="keyboard-key" data-char="," data-shift-char="<">,<span
                                                    class="sub-char"><</span></div>
                                            <div id="key-period" class="keyboard-key" data-char="." data-shift-char=">">
                                                .<span class="sub-char">></span></div>
                                            <div id="key-slash" class="keyboard-key" data-char="/" data-shift-char="?">/<span
                                                    class="sub-char">?</span></div>
                                        </div>
                                        <!-- Row 5 -->
                                        <div class="keyboard-row">
                                            <div id="key-tab" class="keyboard-key special tab" data-action="tab">Tab
                                            </div>
                                            <div id="key-space" class="keyboard-key space" data-char=" "
                                                 data-shift-char=" "></div>
                                            <div id="key-clear" class="keyboard-key special clear" data-action="clear">
                                                Clear
                                            </div>
                                            <div id="key-toggle" class="keyboard-key special toggle"
                                                 data-action="toggle">123
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div id="login-scanner" class="login-method">
                            <h2 data-i18n="login.user_login_by_scanner">User Login by QR-CODE / BARCODE</h2>
                            <div class="scanner-mock">
                                <div class="scanner-animation">
                                    <div class="scanner-line"></div>
                                </div>
                                <p class="error-msg" data-i18n="login.scanner_not_detected">+ Skaner nie zosta≈Ç
                                    wykryty</p>
                                <p data-i18n="login.code_not_read">kod nie zosta≈Ç poprawnie sczytany</p>
                                <button id="use-keyboard-btn" class="btn"
                                        onclick="navigateAction('use-keyboard-btn'); selectLoginMethod('keyword')"
                                        data-i18n="login.use_keyboard">U≈ºyj
                                    klawiatury
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Start Screen -->
        <div id="system-screen" class="screen">
            <div class="menu-container">
                <!--                <div class="menu-header">SYSTEM</div>-->
                <div class="system-content">
                    <h1 data-i18n="system.welcome">Welcome</h1>
                    <div class="system-logo" data-i18n="global.system_name">MASKTRONIC</div>
                    <!--                    <div class="loading-bar">-->
                    <!--                        <div class="loading-progress" id="loading-progress"></div>-->
                    <!--                    </div>-->
                    <p id="loading-text" data-i18n="system.loading_message">System starting in Progress...</p>
                </div>
            </div>
        </div>

        <!-- User Menu Screen -->
        <div id="user-menu-screen" class="screen">
            <div class="menu-container">
                <!--                <div class="menu-header">-->
                <!--                    USER MENU-->
                <!--                    <span id="menu-role-badge" class="role-badge"></span>-->
                <!--                </div>-->
                <div class="menu-layout">
                    <div class="menu-sidebar" id="user-menu-items">
                        <!-- Dynamic menu items based on role -->
                    </div>
                    <div class="menu-content" id="menu-content">
                        <div class="welcome-message">
                            <h2 data-i18n="menu.select_option">Wybierz opcjƒô z menu</h2>
                            <p data-i18n="system.ready">System gotowy do pracy</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pressure Display Panel - Always Visible -->
        <aside id="pressure-panel" class="pressure-panel">
            <h3 id="pressure-panel-title" data-i18n="device.pressure_title">PRESSURE</h3>
            <div class="pressure-box">
                <div class="pressure-item">
                    <div class="pressure-status" id="pressure-low-status"></div>
                    <div id="pressure-low" class="pressure-value">10</div>

                    <span class="pressure-label-unit">
                        <span id="pressure-low-label" class="pressure-label" data-i18n="data.low">Low</span>
                        [<span id="pressure-low-unit" class="pressure-unit">mbar</span>]
                    </span>
                    <div id="pressure-low-dia" class="pressure-dia">
                        <div class="pressure-chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="pressure-box">
                <div class="pressure-item">
                    <div class="pressure-status" id="pressure-medium-status"></div>
                    <div id="pressure-medium" class="pressure-value">20</div>
                    <span class="pressure-label-unit">
                        <span id="pressure-medium-label" class="pressure-label" data-i18n="data.medium">Medium</span>
                        [<span id="pressure-medium-unit" class="pressure-unit">bar</span>]
                    </span>
                    <div id="pressure-medium-dia" class="pressure-dia">
                        <div class="pressure-chart-container"></div>
                    </div>
                </div>
            </div>
            <div class="pressure-box">
                <div class="pressure-item">
                    <div class="pressure-status" id="pressure-high-status"></div>
                    

                    <div id="pressure-high" class="pressure-value">30</div>
                    <span class="pressure-label-unit">
                        <span id="pressure-high-label" class="pressure-label" data-i18n="data.high">High</span>
                        [<span id="pressure-high-unit" class="pressure-unit">bar</span>]
                    </span>
                    <div id="pressure-high-dia" class="pressure-dia">
                        <div class="pressure-chart-container"></div>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-left">
            <span id="user-info" style="display:none;">
<!--                    <span id="username">-&#45;&#45;</span>-->
                <span id="user-name" data-i18n="user.username_placeholder">USERNAME</span>
                <span id="user-role" class="role-badge">---</span>
            </span>

            <!--            <div id="session-info" class="session-info">-->
            <!--                <span>Inactive: <span id="inactive-time">0s</span></span>-->
            <!--                <button onclick="navigateAction('logout-btn'); logout()" class="btn-logout">Logout</button>-->
            <!--            </div>-->


        </div>

        <div class="footer-center">

                <span id="language-selector" class="language-selector">
                    <button id="lang-pl" class="lang-btn active" onclick="changeLanguage('pl')"
                            title="Polski">üáµüá±</button>
                    <button id="lang-en" class="lang-btn" onclick="changeLanguage('en')" title="English">üá∫üá∏</button>
                    <button id="lang-de" class="lang-btn" onclick="changeLanguage('de')" title="Deutsch">üá©üá™</button>
                </span>
        </div>

        <div class="footer-right">

            <span id="time-info">
                <span id="footer-date">--/--/----</span>
                <span id="footer-time" class="role-badge">--:--</span>
            </span>

        </div>
    </footer>
</div>

<!-- Menu Templates -->
<div id="templates" style="display:none;">
    <!-- Test Menu Template -->
    <div id="test-menu-template">
        <h2 data-i18n="test.menu_title">Test Menu</h2>
        <div class="menu-grid">
            <button class="menu-card" onclick="selectTestOption('device')">
                <h3 data-i18n="test.kind_of_device">Kind of Device</h3>
                <p data-i18n="test.select_device_type">Wybierz rodzaj urzƒÖdzenia</p>
            </button>
            <button class="menu-card" onclick="selectTestOption('type')">
                <h3 data-i18n="test.device_type">Device Type</h3>
                <p data-i18n="test.select_device_model">Wybierz typ urzƒÖdzenia</p>
            </button>
            <button class="menu-card" onclick="selectTestOption('test')">
                <h3 data-i18n="test.kind_of_test">Kind of Test</h3>
                <p data-i18n="test.select_test_type">Wybierz rodzaj testu</p>
            </button>
            <button class="menu-card" onclick="selectTestOption('flow')">
                <h3 data-i18n="test.test_flow">Test Flow</h3>
                <p data-i18n="test.test_scenario">Scenariusz testowy</p>
            </button>
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <h3 data-i18n="export.title">Export Test Data</h3>
            <div class="export-buttons">
                <button class="btn-export btn-json" onclick="exportTestData('json')" data-i18n="export.json">JSON
                </button>
                <button class="btn-export btn-xml" onclick="exportTestData('xml')" data-i18n="export.xml">XML</button>
                <button class="btn-export btn-csv" onclick="exportTestData('csv')" data-i18n="export.csv">CSV</button>
                <button class="btn-export btn-pdf" onclick="exportTestData('pdf')" data-i18n="export.pdf">PDF</button>
            </div>
        </div>
    </div>

    <!-- Device Selection Template -->
    <div id="device-select-template">
        <h2 data-i18n="test.kind_of_device">Kind of Device</h2>
        <div class="device-list">
            <button class="device-item" onclick="selectDevice('PP_MASK')" data-i18n="devices.pp_mask">PP Mask</button>
            <button class="device-item" onclick="selectDevice('NP_MASK')" data-i18n="devices.np_mask">NP Mask</button>
            <button class="device-item" onclick="selectDevice('SCBA')" data-i18n="devices.scba">SCBA</button>
            <button class="device-item" onclick="selectDevice('CPS')" data-i18n="devices.cps">CPS Protection Suit
            </button>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Workshop Template -->
    <div id="workshop-template">
        <h2 data-i18n="workshop.title">Workshop</h2>
        <div class="menu-grid">
            <button class="menu-card">
                <h3 data-i18n="workshop.equipment_list">Equipment List</h3>
                <p data-i18n="workshop.equipment_description">Lista sprzƒôtu</p>
            </button>
            <button class="menu-card">
                <h3 data-i18n="workshop.spare_parts">Spare Parts</h3>
                <p data-i18n="workshop.spare_parts_description">Czƒô≈õci zamienne</p>
            </button>
            <button class="menu-card">
                <h3 data-i18n="workshop.maintenance">Maintenance</h3>
                <p data-i18n="workshop.maintenance_description">Harmonogram przeglƒÖd√≥w</p>
            </button>
        </div>
    </div>

    <!-- User Data Template -->
    <div id="user-data-template">
        <h2 data-i18n="user.title">User Data</h2>
        <div class="user-info-grid">
            <div class="info-card">
                <h3 data-i18n="user.current_user">Current User</h3>
                <p id="current-user-name">---</p>
                <p id="current-user-role">---</p>
            </div>
            <div class="info-card">
                <h3 data-i18n="user.session_info">Session Info</h3>
                <p data-i18n="user.login_time">Login time: <span id="login-time">---</span></p>
                <p data-i18n="user.last_activity">Last activity: <span id="last-activity">---</span></p>
            </div>
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <h3 data-i18n="export.title">Export User Data</h3>
            <div class="export-buttons">
                <button class="btn-export btn-json" onclick="exportUserData('json')" data-i18n="export.json">JSON
                </button>
                <button class="btn-export btn-xml" onclick="exportUserData('xml')" data-i18n="export.xml">XML</button>
                <button class="btn-export btn-csv" onclick="exportUserData('csv')" data-i18n="export.csv">CSV</button>
                <button class="btn-export btn-pdf" onclick="exportUserData('pdf')" data-i18n="export.pdf">PDF</button>
            </div>
        </div>
    </div>

    <!-- Device Data Template -->
    <div id="device-data-template">
        <h2 data-i18n="device.title">Device Data</h2>
        <div class="device-info">
            <div class="device-card">
                <h3 data-i18n="device.status_title">Device Status</h3>
                <p data-i18n="device.device_id_label">Device ID: <span id="device-id">RPI_MOCK_001</span></p>
                <p data-i18n="device.status_label">Status: <span id="device-status" class="status-online">ONLINE</span>
                </p>
                <p data-i18n="device.uptime_label">Uptime: <span id="device-uptime">---</span></p>
            </div>
            <div class="sensor-grid">
                <div class="sensor-card">
                    <h4 data-i18n="sensors.temperature">Temperature</h4>
                    <span id="temp-value">22.5¬∞C</span>
                </div>
                <div class="sensor-card">
                    <h4 data-i18n="sensors.humidity">Humidity</h4>
                    <span id="humidity-value">45%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Test Reports Template -->
    <div id="test-reports-template">
        <h2 data-i18n="reports.title">Test Reports</h2>
        <div class="reports-list">
            <div class="report-item">
                <span>Report #001</span>
                <span>2024-01-15</span>
                <button class="btn-small" data-i18n="reports.pdf_button">PDF</button>
            </div>
            <div class="report-item">
                <span>Report #002</span>
                <span>2024-01-16</span>
                <button class="btn-small" data-i18n="reports.pdf_button">PDF</button>
            </div>
        </div>
        <button class="btn btn-primary" data-i18n="reports.generate_new">Generate New Report</button>
    </div>

    <!-- Users Template (ADMIN) -->
    <div id="users-template">
        <h2 data-i18n="users.management_title">Users Management</h2>
        <div class="users-list">
            <div class="user-item">
                <span>operator1</span>
                <span class="role-badge role-operator" data-i18n="roles.operator">OPERATOR</span>
                <button class="btn-small" data-i18n="actions.edit">Edit</button>
            </div>
            <div class="user-item">
                <span>admin1</span>
                <span class="role-badge role-admin" data-i18n="roles.admin">ADMIN</span>
                <button class="btn-small" data-i18n="actions.edit">Edit</button>
            </div>
        </div>
        <button class="btn btn-primary" data-i18n="users.add_user">Add User</button>

        <!-- Export Section -->
        <div class="export-section">
            <h3 data-i18n="export.title">Export Users List</h3>
            <div class="export-buttons">
                <button class="btn-export btn-json" onclick="exportUsersData('json')" data-i18n="export.json">JSON
                </button>
                <button class="btn-export btn-xml" onclick="exportUsersData('xml')" data-i18n="export.xml">XML</button>
                <button class="btn-export btn-csv" onclick="exportUsersData('csv')" data-i18n="export.csv">CSV</button>
                <button class="btn-export btn-pdf" onclick="exportUsersData('pdf')" data-i18n="export.pdf">PDF</button>
            </div>
        </div>
    </div>

    <!-- Service Menu Template (ADMIN) -->
    <div id="service-menu-template">
        <h2 data-i18n="service.menu_title">Service Menu</h2>
        <div class="service-grid">
            <button class="service-card">
                <h3 data-i18n="service.diagnostics">System Diagnostics</h3>
                <p data-i18n="service.diagnostics_desc">Sprawd≈∫ stan systemu</p>
            </button>
            <button class="service-card">
                <h3 data-i18n="service.calibration">Calibration</h3>
                <p data-i18n="service.calibration_desc">Kalibracja czujnik√≥w</p>
            </button>
            <button class="service-card">
                <h3 data-i18n="service.backup">Backup</h3>
                <p data-i18n="service.backup_desc">Kopia zapasowa danych</p>
            </button>
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <h3 data-i18n="export.title">Export Service Data</h3>
            <div class="export-buttons">
                <button class="btn-export btn-json" onclick="exportServiceData('json')" data-i18n="export.json">JSON
                </button>
                <button class="btn-export btn-xml" onclick="exportServiceData('xml')" data-i18n="export.xml">XML
                </button>
                <button class="btn-export btn-csv" onclick="exportServiceData('csv')" data-i18n="export.csv">CSV
                </button>
                <button class="btn-export btn-pdf" onclick="exportServiceData('pdf')" data-i18n="export.pdf">PDF
                </button>
            </div>
        </div>
    </div>

    <!-- System Settings Template (SUPERUSER) -->
    <div id="system-settings-template">
        <h2 data-i18n="settings.title">System Settings</h2>
        <div class="settings-grid">
            <div class="setting-group">
                <h3 data-i18n="settings.network">Network Settings</h3>
                <label data-i18n="settings.ip_address">IP Address: <input type="text" value="192.168.1.10"></label>
                <label data-i18n="settings.port">Port: <input type="text" value="8080"></label>
            </div>
            <div class="setting-group">
                <h3 data-i18n="settings.system_config">System Configuration</h3>
                <label data-i18n="settings.update_interval">Update Interval: <input type="number" value="5">
                    seconds</label>
                <label data-i18n="settings.debug_mode">Debug Mode: <input type="checkbox"></label>
            </div>
        </div>
        <button class="btn btn-primary" data-i18n="actions.save_settings">Save Settings</button>

        <!-- Export Section -->
        <div class="export-section">
            <h3 data-i18n="export.title">Export System Settings</h3>
            <div class="export-buttons">
                <button class="btn-export btn-json" onclick="exportSettingsData('json')" data-i18n="export.json">JSON
                </button>
                <button class="btn-export btn-xml" onclick="exportSettingsData('xml')" data-i18n="export.xml">XML
                </button>
                <button class="btn-export btn-csv" onclick="exportSettingsData('csv')" data-i18n="export.csv">CSV
                </button>
                <button class="btn-export btn-pdf" onclick="exportSettingsData('pdf')" data-i18n="export.pdf">PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Device History Template -->
    <div id="device-history-template">
        <h2 data-i18n="device.history_title">Device History</h2>
        <div class="history-container">
            <div class="filter-section">
                <input type="text" placeholder="Search devices..." data-i18n-placeholder="device.search_placeholder"
                       class="search-input">
                <select class="filter-select">
                    <option value="all" data-i18n="device.filter_all">All Devices</option>
                    <option value="PP_MASK" data-i18n="devices.pp_mask">PP Mask</option>
                    <option value="NP_MASK" data-i18n="devices.np_mask">NP Mask</option>
                    <option value="SCBA" data-i18n="devices.scba">SCBA</option>
                    <option value="CPS" data-i18n="devices.cps">CPS Protection Suit</option>
                </select>
            </div>
            <div class="history-list">
                <div class="history-item">
                    <div class="device-info">
                        <span class="device-name">PP-MASK-001</span>
                        <span class="device-status status-active">Active</span>
                    </div>
                    <div class="last-test">Last test: 2025-09-20 14:30</div>
                    <div class="test-result status-passed">PASSED</div>
                </div>
                <div class="history-item">
                    <div class="device-info">
                        <span class="device-name">NP-MASK-003</span>
                        <span class="device-status status-maintenance">Maintenance</span>
                    </div>
                    <div class="last-test">Last test: 2025-09-18 09:15</div>
                    <div class="test-result status-failed">FAILED</div>
                </div>
            </div>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Reports View Template -->
    <div id="reports-view-template">
        <h2 data-i18n="reports.view_title">Reports View</h2>
        <div class="reports-container">
            <div class="report-filters">
                <div class="filter-group">
                    <label data-i18n="reports.date_from">Date From:</label>
                    <input type="date" class="date-input" id="date-from">
                </div>
                <div class="filter-group">
                    <label data-i18n="reports.date_to">Date To:</label>
                    <input type="date" class="date-input" id="date-to">
                </div>
                <div class="filter-group">
                    <label data-i18n="reports.device_type">Device Type:</label>
                    <select class="filter-select">
                        <option value="all" data-i18n="device.filter_all">All Types</option>
                        <option value="PP_MASK" data-i18n="devices.pp_mask">PP Mask</option>
                        <option value="NP_MASK" data-i18n="devices.np_mask">NP Mask</option>
                        <option value="SCBA" data-i18n="devices.scba">SCBA</option>
                        <option value="CPS" data-i18n="devices.cps">CPS Protection Suit</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="generateReport()" data-i18n="reports.generate">Generate
                    Report
                </button>
            </div>
            <div class="report-results">
                <div class="report-summary">
                    <div class="summary-card">
                        <h3 data-i18n="reports.total_tests">Total Tests</h3>
                        <span class="summary-number">247</span>
                    </div>
                    <div class="summary-card">
                        <h3 data-i18n="reports.passed_tests">Passed</h3>
                        <span class="summary-number passed">231</span>
                    </div>
                    <div class="summary-card">
                        <h3 data-i18n="reports.failed_tests">Failed</h3>
                        <span class="summary-number failed">16</span>
                    </div>
                </div>
            </div>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Reports Batch Template -->
    <div id="reports-batch-template">
        <h2 data-i18n="reports.batch_title">Batch Reports Generator</h2>
        <div class="batch-container">
            <div class="batch-settings">
                <div class="setting-group">
                    <label data-i18n="reports.batch_period">Report Period:</label>
                    <select class="batch-select">
                        <option value="daily" data-i18n="reports.daily">Daily</option>
                        <option value="weekly" data-i18n="reports.weekly">Weekly</option>
                        <option value="monthly" data-i18n="reports.monthly">Monthly</option>
                        <option value="quarterly" data-i18n="reports.quarterly">Quarterly</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label data-i18n="reports.output_format">Output Format:</label>
                    <div class="format-options">
                        <label><input type="checkbox" value="pdf" checked> PDF</label>
                        <label><input type="checkbox" value="excel"> Excel</label>
                        <label><input type="checkbox" value="csv"> CSV</label>
                        <label><input type="checkbox" value="json"> JSON</label>
                    </div>
                </div>
                <div class="setting-group">
                    <label data-i18n="reports.email_recipients">Email Recipients:</label>
                    <textarea placeholder="Enter email addresses (one per line)"
                              data-i18n-placeholder="reports.email_placeholder" class="email-input"></textarea>
                </div>
                <div class="setting-group">
                    <label data-i18n="reports.schedule">Schedule:</label>
                    <select class="batch-select">
                        <option value="manual" data-i18n="reports.manual">Manual Only</option>
                        <option value="auto-daily" data-i18n="reports.auto_daily">Auto Daily</option>
                        <option value="auto-weekly" data-i18n="reports.auto_weekly">Auto Weekly</option>
                        <option value="auto-monthly" data-i18n="reports.auto_monthly">Auto Monthly</option>
                    </select>
                </div>
            </div>
            <div class="batch-actions">
                <button class="btn btn-primary" onclick="generateBatchReport()" data-i18n="reports.generate_now">
                    Generate Now
                </button>
                <button class="btn btn-secondary" onclick="scheduleBatchReport()" data-i18n="reports.schedule_report">
                    Schedule Report
                </button>
                <button class="btn btn-info" onclick="previewBatchReport()" data-i18n="reports.preview">Preview</button>
            </div>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Real-time Sensors Template -->
    <div id="realtime-sensors-template">
        <h2 data-i18n="sensors.title">Real-time Sensors</h2>
        <div class="sensors-container">
            <div class="sensor-grid">
                <div class="sensor-card">
                    <h3 data-i18n="sensors.pressure">Pressure</h3>
                    <div class="sensor-value">15.2 <span class="unit">kPa</span></div>
                    <div class="sensor-status status-normal">Normal</div>
                </div>
                <div class="sensor-card">
                    <h3 data-i18n="sensors.temperature">Temperature</h3>
                    <div class="sensor-value">22.5 <span class="unit">¬∞C</span></div>
                    <div class="sensor-status status-normal">Normal</div>
                </div>
                <div class="sensor-card">
                    <h3 data-i18n="sensors.humidity">Humidity</h3>
                    <div class="sensor-value">45 <span class="unit">%</span></div>
                    <div class="sensor-status status-warning">Warning</div>
                </div>
                <div class="sensor-card">
                    <h3 data-i18n="sensors.flow_rate">Flow Rate</h3>
                    <div class="sensor-value">8.7 <span class="unit">L/min</span></div>
                    <div class="sensor-status status-normal">Normal</div>
                </div>
            </div>
            <div class="sensor-controls">
                <button class="btn btn-primary" onclick="refreshSensors()" data-i18n="sensors.refresh">Refresh Data
                </button>
                <button class="btn btn-secondary" onclick="exportSensorData()" data-i18n="sensors.export">Export Data
                </button>
            </div>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Reports Schedule Template -->
    <div id="reports-schedule-template">
        <h2 data-i18n="reports.schedule_title">Report Schedule</h2>
        <div class="schedule-container">
            <div class="schedule-list">
                <div class="schedule-item">
                    <div class="schedule-info">
                        <h3>Daily Test Summary</h3>
                        <p>Every day at 18:00</p>
                    </div>
                    <div class="schedule-status status-active">Active</div>
                    <div class="schedule-actions">
                        <button class="btn btn-sm btn-primary">Edit</button>
                        <button class="btn btn-sm btn-danger">Disable</button>
                    </div>
                </div>
                <div class="schedule-item">
                    <div class="schedule-info">
                        <h3>Weekly Equipment Report</h3>
                        <p>Every Monday at 09:00</p>
                    </div>
                    <div class="schedule-status status-active">Active</div>
                    <div class="schedule-actions">
                        <button class="btn btn-sm btn-primary">Edit</button>
                        <button class="btn btn-sm btn-danger">Disable</button>
                    </div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="addScheduledReport()" data-i18n="reports.add_schedule">Add New
                Schedule
            </button>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Workshop Parts Template -->
    <div id="workshop-parts-template">
        <h2 data-i18n="workshop.parts_title">Workshop Parts</h2>
        <div class="parts-container">
            <div class="search-filter">
                <input type="text" placeholder="Search parts..." data-i18n-placeholder="workshop.search_parts"
                       class="search-input">
                <select class="filter-select">
                    <option value="all" data-i18n="workshop.all_categories">All Categories</option>
                    <option value="masks" data-i18n="workshop.masks">Masks</option>
                    <option value="filters" data-i18n="workshop.filters">Filters</option>
                    <option value="valves" data-i18n="workshop.valves">Valves</option>
                    <option value="seals" data-i18n="workshop.seals">Seals</option>
                </select>
            </div>
            <div class="parts-list">
                <div class="part-item">
                    <div class="part-info">
                        <span class="part-name">HEPA Filter H13</span>
                        <span class="part-code">HF-H13-001</span>
                    </div>
                    <div class="part-stock">Stock: 25</div>
                    <div class="part-status status-available">Available</div>
                </div>
                <div class="part-item">
                    <div class="part-info">
                        <span class="part-name">Rubber Seal Set</span>
                        <span class="part-code">RS-SET-002</span>
                    </div>
                    <div class="part-stock">Stock: 8</div>
                    <div class="part-status status-low">Low Stock</div>
                </div>
            </div>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Workshop Maintenance Template -->
    <div id="workshop-maintenance-template">
        <h2 data-i18n="workshop.maintenance_title">Maintenance Schedule</h2>
        <div class="maintenance-container">
            <div class="maintenance-calendar">
                <div class="calendar-header">
                    <button class="btn btn-sm" onclick="previousMonth()" data-i18n="calendar.previous">‚Äπ</button>
                    <h3 id="calendar-title">September 2025</h3>
                    <button class="btn btn-sm" onclick="nextMonth()" data-i18n="calendar.next">‚Ä∫</button>
                </div>
                <div class="maintenance-list">
                    <div class="maintenance-item">
                        <div class="maintenance-date">Sep 25, 2025</div>
                        <div class="maintenance-task">PP-MASK-001 - Quarterly Check</div>
                        <div class="maintenance-status status-pending">Pending</div>
                    </div>
                    <div class="maintenance-item">
                        <div class="maintenance-date">Sep 28, 2025</div>
                        <div class="maintenance-task">SCBA-003 - Annual Service</div>
                        <div class="maintenance-status status-scheduled">Scheduled</div>
                    </div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="addMaintenanceTask()" data-i18n="workshop.add_maintenance">Add
                Maintenance Task
            </button>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Workshop Tools Template -->
    <div id="workshop-tools-template">
        <h2 data-i18n="workshop.tools_title">Calibration Tools</h2>
        <div class="tools-container">
            <div class="tools-grid">
                <div class="tool-card">
                    <h3 data-i18n="tools.pressure_tester">Pressure Tester</h3>
                    <div class="tool-info">
                        <p>Model: PT-2000</p>
                        <p>Last Calibration: 2025-08-15</p>
                        <p>Next Due: 2025-11-15</p>
                    </div>
                    <div class="tool-status status-calibrated">Calibrated</div>
                </div>
                <div class="tool-card">
                    <h3 data-i18n="tools.flow_meter">Flow Meter</h3>
                    <div class="tool-info">
                        <p>Model: FM-500</p>
                        <p>Last Calibration: 2025-07-20</p>
                        <p>Next Due: 2025-10-20</p>
                    </div>
                    <div class="tool-status status-due">Due Soon</div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="scheduleCalibration()" data-i18n="tools.schedule_calibration">
                Schedule Calibration
            </button>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

    <!-- Workshop Inventory Template -->
    <div id="workshop-inventory-template">
        <h2 data-i18n="workshop.inventory_title">Inventory</h2>
        <div class="inventory-container">
            <div class="inventory-summary">
                <div class="summary-card">
                    <h3 data-i18n="inventory.total_items">Total Items</h3>
                    <span class="summary-number">342</span>
                </div>
                <div class="summary-card">
                    <h3 data-i18n="inventory.low_stock">Low Stock</h3>
                    <span class="summary-number warning">12</span>
                </div>
                <div class="summary-card">
                    <h3 data-i18n="inventory.out_of_stock">Out of Stock</h3>
                    <span class="summary-number critical">3</span>
                </div>
            </div>
            <div class="inventory-actions">
                <button class="btn btn-primary" onclick="generateInventoryReport()"
                        data-i18n="inventory.generate_report">Generate Report
                </button>
                <button class="btn btn-secondary" onclick="orderParts()" data-i18n="inventory.order_parts">Order Parts
                </button>
                <button class="btn btn-info" onclick="viewLowStock()" data-i18n="inventory.view_low_stock">View Low
                    Stock
                </button>
            </div>
        </div>
        <button class="btn btn-back" onclick="backToMenu()" data-i18n="navigation.back">‚Üê Powr√≥t</button>
    </div>

</div>

<!-- Global Loading Overlay -->
<div id="loading-overlay" class="loading-overlay" style="display:none;">
    <div class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">
            <h3 data-i18n="loading.title">Logowanie...</h3>
            <p data-i18n="loading.message">Proszƒô czekaƒá</p>
        </div>
    </div>
</div>

<!-- MASKTRONIC C20 - Simple Script Loading -->
<script>
    // Global configuration for MASKTRONIC C20
    const cacheBuster = Date.now();
    window.MASKTRONIC_CONFIG = {
        version: '2.0.1001',
        cacheBuster: cacheBuster,
        debug: window.location.search.includes('debug=true')
    };
    
    console.log('üîß MASKTRONIC C20 v' + window.MASKTRONIC_CONFIG.version + ' - Simple Script Loading');
    console.log('‚ö° Cache buster: ' + cacheBuster);
</script>

<!-- Core modules loaded in dependency order with cache buster -->
<script>
    // Dynamic script loading with cache buster
    const scripts = [
        'js/utils.js',
        'js/config.js',
        'js/auth.js',
        'js/keyboard.js',
        'js/menu.js',
        'js/modules/data-export.js',
        'js/modules/settings-ui-generator.js',
        'js/modules/template-validator.js',
        'js/modules/view-tester.js',
        'js/router.js'
    ];
    
    scripts.forEach(function(src) {
        document.write('<script src="' + src + '?v=' + cacheBuster + '"><\/script>');
    });
    
    // Add automated test suite (only on localhost)
    if (window.location.hostname === 'localhost') {
        document.write('<script src="test.js?v=' + cacheBuster + '"><\/script>');
        //document.write('<script src="vue-component-menu-validator.js?v=' + cacheBuster + '"><\/script>');
    }
</script>

<script>
    // Initialize application after all scripts are loaded
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üöÄ MASKTRONIC C20 application starting...');
        
        // Initialize the application
        if (typeof window.MasktronicApp !== 'undefined') {
            window.app = new MasktronicApp();
            console.log('‚úÖ MASKTRONIC C20 application loaded successfully');
        } else {
            console.error('‚ùå MasktronicApp not available');
        }
    });
</script>

<!-- jsPDF Library for PDF Export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- Vue.js Application Container -->
<div id="vue-app" class="vue-overlay">
    <!-- Vue components will be mounted here -->
</div>

<!-- Vue.js Migration Scripts -->
<script src="js/components/LoginScreen.js?v=" type="text/javascript"></script>
<script src="js/components/SystemScreen.js?v=" type="text/javascript"></script>
<script src="js/components/UserMenuScreen.js?v=" type="text/javascript"></script>
<script src="js/components/TestMenuTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/UserDataTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/DeviceSelectTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/DeviceDataTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/RealtimeSensorsTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/ReportsViewTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/SystemSettingsTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/ServiceMenuTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/UsersTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/WorkshopTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/TestReportsTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/DeviceHistoryTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/ReportsBatchTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/ReportsScheduleTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/WorkshopInventoryTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/WorkshopMaintenanceTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/WorkshopPartsTemplate.js?v=" type="text/javascript"></script>
<script src="js/components/WorkshopToolsTemplate.js?v=" type="text/javascript"></script>
<script src="js/modules/vue-view-loader.js?v=" type="text/javascript"></script>
<script src="js/vue-i18n.js?v=" type="text/javascript"></script>
<script src="js/vue-sensor-monitoring.js?v=" type="text/javascript"></script>
<script src="js/vue-app.js?v=" type="text/javascript"></script>

<!-- Vue.js Application Initialization -->
<script>
    // Vue.js Application Startup
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üî∂ Starting Vue.js integration for MASKTRONIC C20...');
        
        // Initialize Vue app when DOM is ready
        setTimeout(() => {
            try {
                // Register Vue components
                if (window.MaskServiceVue && window.LoginScreen) {
                    window.MaskServiceVue.registerComponent('LoginScreen', window.LoginScreen);
                    console.log('‚úÖ LoginScreen component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.SystemScreen) {
                    window.MaskServiceVue.registerComponent('SystemScreen', window.SystemScreen);
                    console.log('‚úÖ SystemScreen component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.UserMenuScreen) {
                    window.MaskServiceVue.registerComponent('UserMenuScreen', window.UserMenuScreen);
                    console.log('‚úÖ UserMenuScreen component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.TestMenuTemplate) {
                    window.MaskServiceVue.registerComponent('TestMenuTemplate', window.TestMenuTemplate);
                    console.log('‚úÖ TestMenuTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.UserDataTemplate) {
                    window.MaskServiceVue.registerComponent('UserDataTemplate', window.UserDataTemplate);
                    console.log('‚úÖ UserDataTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.DeviceSelectTemplate) {
                    window.MaskServiceVue.registerComponent('DeviceSelectTemplate', window.DeviceSelectTemplate);
                    console.log('‚úÖ DeviceSelectTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.DeviceDataTemplate) {
                    window.MaskServiceVue.registerComponent('DeviceDataTemplate', window.DeviceDataTemplate);
                    console.log('‚úÖ DeviceDataTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.RealtimeSensorsTemplate) {
                    window.MaskServiceVue.registerComponent('RealtimeSensorsTemplate', window.RealtimeSensorsTemplate);
                    console.log('‚úÖ RealtimeSensorsTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.ReportsViewTemplate) {
                    window.MaskServiceVue.registerComponent('ReportsViewTemplate', window.ReportsViewTemplate);
                    console.log('‚úÖ ReportsViewTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.SystemSettingsTemplate) {
                    window.MaskServiceVue.registerComponent('SystemSettingsTemplate', window.SystemSettingsTemplate);
                    console.log('‚úÖ SystemSettingsTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.ServiceMenuTemplate) {
                    window.MaskServiceVue.registerComponent('ServiceMenuTemplate', window.ServiceMenuTemplate);
                    console.log('‚úÖ ServiceMenuTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.UsersTemplate) {
                    window.MaskServiceVue.registerComponent('UsersTemplate', window.UsersTemplate);
                    console.log('‚úÖ UsersTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.WorkshopTemplate) {
                    window.MaskServiceVue.registerComponent('WorkshopTemplate', window.WorkshopTemplate);
                    console.log('‚úÖ WorkshopTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.TestReportsTemplate) {
                    window.MaskServiceVue.registerComponent('TestReportsTemplate', window.TestReportsTemplate);
                    console.log('‚úÖ TestReportsTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.DeviceHistoryTemplate) {
                    window.MaskServiceVue.registerComponent('DeviceHistoryTemplate', window.DeviceHistoryTemplate);
                    console.log('‚úÖ DeviceHistoryTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.ReportsBatchTemplate) {
                    window.MaskServiceVue.registerComponent('ReportsBatchTemplate', window.ReportsBatchTemplate);
                    console.log('‚úÖ ReportsBatchTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.ReportsScheduleTemplate) {
                    window.MaskServiceVue.registerComponent('ReportsScheduleTemplate', window.ReportsScheduleTemplate);
                    console.log('‚úÖ ReportsScheduleTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.WorkshopInventoryTemplate) {
                    window.MaskServiceVue.registerComponent('WorkshopInventoryTemplate', window.WorkshopInventoryTemplate);
                    console.log('‚úÖ WorkshopInventoryTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.WorkshopMaintenanceTemplate) {
                    window.MaskServiceVue.registerComponent('WorkshopMaintenanceTemplate', window.WorkshopMaintenanceTemplate);
                    console.log('‚úÖ WorkshopMaintenanceTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.WorkshopPartsTemplate) {
                    window.MaskServiceVue.registerComponent('WorkshopPartsTemplate', window.WorkshopPartsTemplate);
                    console.log('‚úÖ WorkshopPartsTemplate component registered with Vue app');
                }
                
                if (window.MaskServiceVue && window.WorkshopToolsTemplate) {
                    window.MaskServiceVue.registerComponent('WorkshopToolsTemplate', window.WorkshopToolsTemplate);
                    console.log('‚úÖ WorkshopToolsTemplate component registered with Vue app');
                }
                
                // Mount Vue app
                if (window.MaskServiceVue) {
                    const vueAppInstance = window.MaskServiceVue.mount('#vue-app');
                    if (vueAppInstance) {
                        console.log('‚úÖ Vue.js app mounted successfully');
                        
                        // Add Vue toggle functionality
                        window.toggleVueMode = function() {
                            const vueContainer = document.getElementById('vue-app');
                            const vanillaContainer = document.getElementById('app');
                            
                            if (vueContainer.classList.contains('active')) {
                                // Switch to vanilla
                                vueContainer.classList.remove('active');
                                vanillaContainer.style.display = 'block';
                                console.log('üîÑ Switched to Vanilla JS mode');
                            } else {
                                // Switch to Vue
                                vueContainer.classList.add('active');
                                vanillaContainer.style.display = 'none';
                                console.log('üîÑ Switched to Vue.js mode');
                            }
                        };
                        
                        // Add keyboard shortcut to toggle Vue mode (Ctrl+Shift+V)
                        document.addEventListener('keydown', function(e) {
                            if (e.ctrlKey && e.shiftKey && e.key === 'V') {
                                e.preventDefault();
                                window.toggleVueMode();
                            }
                        });
                        
                        console.log('üî∂ Vue/Vanilla toggle ready: Press Ctrl+Shift+V');
                    }
                }
            } catch (error) {
                console.error('‚ùå Vue.js initialization failed:', error);
            }
        }, 100);
    });

    // Advanced Pressure Visualization System
    class AdvancedPressureVisualization {
        constructor() {
            this.pressureHistory = {
                low: Array(60).fill(10),
                medium: Array(60).fill(20),
                high: Array(60).fill(30)
            };
            this.init();
        }

        init() {
            this.initializePressureCharts();
            this.startSimulation();
        }

        initializePressureCharts() {
            const types = ['low', 'medium', 'high'];
            types.forEach(type => {
                const container = document.querySelector(`#pressure-${type}-dia .pressure-chart-container`);
                if (container) {
                    this.renderPressureChart(type);
                }
            });
        }

        renderPressureChart(type) {
            const container = document.querySelector(`#pressure-${type}-dia .pressure-chart-container`);
            if (!container) return;

            const data = this.pressureHistory[type];
            const maxValue = Math.max(...data) || 1;
            const minValue = Math.min(...data) || 0;
            const range = maxValue - minValue || 1;

            container.innerHTML = '';

            data.forEach((value, index) => {
                const line = document.createElement('div');
                line.className = 'pressure-chart-line';
                
                const normalizedValue = ((value - minValue) / range) * 100;
                const height = Math.max(2, normalizedValue);
                
                line.style.height = `${height}%`;
                line.style.left = `${(index / 59) * 100}%`;
                line.style.backgroundColor = this.getPressureColor(type, value);
                
                line.addEventListener('mouseenter', (e) => {
                    this.showTooltip(e, type, value, index);
                });
                
                line.addEventListener('mouseleave', () => {
                    this.hideTooltip();
                });
                
                container.appendChild(line);
            });

            this.updatePressureStatus(type, data[data.length - 1]);
        }

        getPressureColor(type, value) {
            const ranges = {
                low: { min: 8, max: 12 },
                medium: { min: 18, max: 22 },
                high: { min: 28, max: 32 }
            };

            const range = ranges[type];
            if (!range) return '#3498db';
            
            if (value < range.min) {
                return '#ef4444';
            } else if (value > range.max) {
                return '#f97316';
            } else {
                return '#22c55e';
            }
        }

        updatePressureStatus(type, value) {
            const statusElement = document.getElementById(`pressure-${type}-status`);
            const valueElement = document.getElementById(`pressure-${type}`);
            
            if (!statusElement || !valueElement) return;

            const ranges = {
                low: { min: 8, max: 12 },
                medium: { min: 18, max: 22 },
                high: { min: 28, max: 32 }
            };

            const range = ranges[type];
            statusElement.className = 'pressure-status';
            valueElement.className = 'pressure-value';
            
            if (range) {
                if (value < range.min || value > range.max) {
                    statusElement.classList.add('danger');
                    valueElement.classList.add('danger');
                } else if (value < range.min + 1 || value > range.max - 1) {
                    statusElement.classList.add('warning');
                    valueElement.classList.add('warning');
                }
            }
        }

        showTooltip(event, type, value, index) {
            this.hideTooltip();
            
            const tooltip = document.createElement('div');
            tooltip.className = 'pressure-tooltip';
            tooltip.innerHTML = `
                <div class="tooltip-header">${type.toUpperCase()} Pressure</div>
                <div class="tooltip-value">${value.toFixed(1)} ${this.getUnit(type)}</div>
                <div class="tooltip-time">${60 - index}s ago</div>
            `;
            
            document.body.appendChild(tooltip);
            
            const rect = event.target.getBoundingClientRect();
            tooltip.style.left = `${rect.left + window.scrollX}px`;
            tooltip.style.top = `${rect.top + window.scrollY - tooltip.offsetHeight - 5}px`;
        }

        hideTooltip() {
            const tooltip = document.querySelector('.pressure-tooltip');
            if (tooltip) {
                tooltip.remove();
            }
        }

        getUnit(type) {
            const units = { low: 'mbar', medium: 'bar', high: 'bar' };
            return units[type] || 'bar';
        }

        updatePressure(type, value) {
            this.pressureHistory[type].shift();
            this.pressureHistory[type].push(value);
            
            const valueElement = document.getElementById(`pressure-${type}`);
            if (valueElement) {
                valueElement.textContent = value.toFixed(1);
            }
            
            this.renderPressureChart(type);
        }

        startSimulation() {
            setInterval(() => {
                this.updatePressure('low', 10 + Math.random() * 2);
                this.updatePressure('medium', 20 + Math.random() * 2);
                this.updatePressure('high', 30 + Math.random() * 2);
            }, 1000);
        }
    }

    // Enhanced Translation System
    class EnhancedTranslationSystem {
        constructor() {
            this.translations = {};
            this.currentLanguage = 'pl';
            this.init();
        }

        async init() {
            await this.loadTranslations();
            this.setupLanguageButtons();
            this.applyTranslations();
        }

        async loadTranslations() {
            try {
                const languages = ['pl', 'en', 'de'];
                
                for (const lang of languages) {
                    const response = await fetch(`./locales/${lang}.json`);
                    const data = await response.json();
                    this.translations[lang] = data;
                }
                
                console.log('‚úÖ Translations loaded from /locales');
            } catch (error) {
                console.error('‚ùå Failed to load translations:', error);
                this.loadFallbackTranslations();
            }
        }

        loadFallbackTranslations() {
            this.translations = {
                pl: {
                    global: { offline: 'OFFLINE', online: 'ONLINE' },
                    data: { pressure: 'Ci≈õnienie', low: 'Niskie', medium: '≈örednie', high: 'Wysokie' }
                },
                en: {
                    global: { offline: 'OFFLINE', online: 'ONLINE' },
                    data: { pressure: 'Pressure', low: 'Low', medium: 'Medium', high: 'High' }
                },
                de: {
                    global: { offline: 'OFFLINE', online: 'ONLINE' },
                    data: { pressure: 'Druck', low: 'Niedrig', medium: 'Mittel', high: 'Hoch' }
                }
            };
        }

        setupLanguageButtons() {
            const buttons = document.querySelectorAll('.lang-btn');
            buttons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const lang = e.target.id.split('-')[1];
                    this.changeLanguage(lang);
                });
            });
        }

        changeLanguage(lang) {
            if (!this.translations[lang]) return;
            
            this.currentLanguage = lang;
            
            // Update active button
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`lang-${lang}`).classList.add('active');
            
            this.applyTranslations();
            console.log(`üåê Language changed to: ${lang}`);
        }

        applyTranslations() {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                const translation = this.getTranslation(key);
                if (translation) {
                    element.textContent = translation;
                }
            });
        }

        getTranslation(key) {
            const keys = key.split('.');
            let value = this.translations[this.currentLanguage];
            
            for (const k of keys) {
                if (value && typeof value === 'object') {
                    value = value[k];
                } else {
                    return null;
                }
            }
            
            return value;
        }
    }

    // Enhanced Role Menu Management System
    class RoleMenuManager {
        constructor() {
            this.currentRole = null;
            this.currentExpandedMenu = null;
            this.menuContent = new Map();
            this.init();
        }

        init() {
            this.setupMenuContent();
            console.log('‚úÖ Role Menu Manager initialized');
        }

        setupMenuContent() {
            // Define role-specific menu content
            this.menuContent.set('OPERATOR', {
                welcome: {
                    title: 'Operator Panel',
                    description: 'Access test operations and basic reports'
                },
                cards: [
                    { id: 'test_wizard', icon: 'üßô', title: 'Test Wizard', desc: 'Guided test setup' },
                    { id: 'test_quick', icon: '‚ö°', title: 'Quick Test', desc: 'Fast device testing' },
                    { id: 'device_history', icon: 'üìú', title: 'Device History', desc: 'View test history' },
                    { id: 'reports_view', icon: 'üìÑ', title: 'View Reports', desc: 'Browse test reports' }
                ]
            });

            this.menuContent.set('ADMIN', {
                welcome: {
                    title: 'Administrator Panel',
                    description: 'Manage users, reports, and system settings'
                },
                cards: [
                    { id: 'test_wizard', icon: 'üßô', title: 'Test Wizard', desc: 'Advanced test configuration' },
                    { id: 'test_scenarios', icon: 'üìã', title: 'Test Scenarios', desc: 'Manage test templates' },
                    { id: 'reports_batch', icon: 'üìä', title: 'Batch Reports', desc: 'Generate bulk reports' },
                    { id: 'reports_schedule', icon: '‚è∞', title: 'Report Schedule', desc: 'Automated reporting' },
                    { id: 'users_management', icon: 'üë•', title: 'User Management', desc: 'Manage system users' },
                    { id: 'settings_system', icon: '‚öôÔ∏è', title: 'System Settings', desc: 'Configure system' }
                ]
            });

            this.menuContent.set('SERVICEUSER', {
                welcome: {
                    title: 'Service Panel',
                    description: 'Workshop management and device maintenance'
                },
                cards: [
                    { id: 'workshop_inventory', icon: 'üì¶', title: 'Inventory', desc: 'Manage spare parts' },
                    { id: 'workshop_maintenance', icon: 'üîß', title: 'Maintenance', desc: 'Schedule maintenance' },
                    { id: 'workshop_parts', icon: 'üõ†Ô∏è', title: 'Spare Parts', desc: 'Parts catalog' },
                    { id: 'workshop_tools', icon: 'üî®', title: 'Tools', desc: 'Calibration tools' },
                    { id: 'device_diagnostics', icon: 'üîç', title: 'Diagnostics', desc: 'Device analysis' }
                ]
            });

            this.menuContent.set('SUPERUSER', {
                welcome: {
                    title: 'Super Admin Panel',
                    description: 'Full system access and configuration'
                },
                cards: [
                    { id: 'system_config', icon: 'üîß', title: 'System Config', desc: 'Core system settings' },
                    { id: 'advanced_diagnostics', icon: 'üî¨', title: 'Advanced Diagnostics', desc: 'Deep system analysis' },
                    { id: 'security_settings', icon: 'üîê', title: 'Security', desc: 'Security configuration' },
                    { id: 'backup_restore', icon: 'üíæ', title: 'Backup & Restore', desc: 'Data management' },
                    { id: 'audit_logs', icon: 'üìã', title: 'Audit Logs', desc: 'System audit trail' },
                    { id: 'network_config', icon: 'üåê', title: 'Network Config', desc: 'Network settings' }
                ]
            });
        }

        toggleRoleMenu(role) {
            const menuId = role.toLowerCase() + '-menu';
            const menu = document.getElementById(menuId);
            
            if (!menu) return;
            
            // Close other expanded menus
            if (this.currentExpandedMenu && this.currentExpandedMenu !== menuId) {
                const prevMenu = document.getElementById(this.currentExpandedMenu);
                if (prevMenu) {
                    prevMenu.classList.remove('role-menu-expanded');
                    prevMenu.classList.add('role-menu-collapsed');
                }
            }
            
            // Toggle current menu
            if (menu.classList.contains('role-menu-collapsed')) {
                menu.classList.remove('role-menu-collapsed');
                menu.classList.add('role-menu-expanded');
                this.currentExpandedMenu = menuId;
            } else {
                menu.classList.remove('role-menu-expanded');
                menu.classList.add('role-menu-collapsed');
                this.currentExpandedMenu = null;
            }
        }

        mockLoginWithMenu(role) {
            this.currentRole = role;
            
            // Skip loading screen - go directly to menu
            setTimeout(() => {
                this.showRoleMenu(role);
                this.updateUserInfo(role);
            }, 100);
        }

        showRoleMenu(role) {
            const menuContent = document.getElementById('menu-content');
            if (!menuContent) return;

            const content = this.menuContent.get(role);
            if (!content) return;

            // Create compact horizontal menu layout
            const html = `
                <div class="welcome-message">
                    <h2>${content.welcome.title}</h2>
                    <p>${content.welcome.description}</p>
                </div>
                
                <div class="menu-content-horizontal">
                    ${content.cards.map(card => `
                        <div class="menu-card" onclick="window.MenuManager?.selectMenuOption('${card.id}') || selectMenuOption('${card.id}')">
                            <h3>${card.icon} ${card.title}</h3>
                            <p>${card.desc}</p>
                        </div>
                    `).join('')}
                </div>
                
                ${content.cards.length > 4 ? this.createExtendedMenuSidebar(content.cards.slice(4)) : ''}
            `;

            menuContent.innerHTML = html;
            
            // Update header status
            const statusText = document.getElementById('status-text');
            if (statusText) {
                statusText.textContent = 'ONLINE';
                statusText.className = 'role-badge online';
            }
            
            console.log(`üéØ Logged in as ${role} - Menu displayed`);
        }

        createExtendedMenuSidebar(extraCards) {
            return `
                <div class="menu-sidebar-extended" style="position: static; margin-top: 1rem;">
                    <h4 style="padding: 0.75rem 1rem; margin: 0; background: #f8f9fa; font-size: 0.9rem;">Additional Options</h4>
                    ${extraCards.map(card => `
                        <div class="extended-menu-item" onclick="window.MenuManager?.selectMenuOption('${card.id}') || selectMenuOption('${card.id}')">
                            <span class="extended-menu-icon">${card.icon}</span>
                            <span class="extended-menu-label">${card.title}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        updateUserInfo(role) {
            // Update session info if exists
            const sessionInfo = document.getElementById('session-info');
            if (sessionInfo) {
                sessionInfo.style.display = 'block';
            }
            
            // Update any user role displays
            const roleElements = document.querySelectorAll('[data-role]');
            roleElements.forEach(el => {
                el.textContent = role;
            });
        }

        selectMenuOption(optionId) {
            console.log(`üìÇ Selected menu option: ${optionId}`);
            
            // Handle menu selection
            if (window.MenuManager && window.MenuManager.selectMenuOption) {
                window.MenuManager.selectMenuOption(optionId);
            } else {
                // Fallback handling
                this.handleMenuSelection(optionId);
            }
        }

        handleMenuSelection(optionId) {
            const menuContent = document.getElementById('menu-content');
            if (!menuContent) return;

            // Simple fallback content
            menuContent.innerHTML = `
                <div class="welcome-message">
                    <h2>üîß ${optionId.replace('_', ' ').toUpperCase()}</h2>
                    <p>Module loading... Please wait.</p>
                </div>
                <div style="text-align: center; padding: 2rem;">
                    <div class="loading-spinner" style="margin: 0 auto 1rem;"></div>
                    <p>Loading ${optionId} module...</p>
                </div>
            `;
        }
    }

    // Global functions for role menu management
    window.toggleRoleMenu = function(role) {
        if (window.roleMenuManager) {
            window.roleMenuManager.toggleRoleMenu(role);
        }
    };

    window.mockLoginWithMenu = function(role) {
        if (window.roleMenuManager) {
            window.roleMenuManager.mockLoginWithMenu(role);
        }
    };

    window.selectMenuOption = function(optionId) {
        if (window.roleMenuManager) {
            window.roleMenuManager.selectMenuOption(optionId);
        }
    };

    // Initialize Enhanced Systems
    document.addEventListener('DOMContentLoaded', () => {
        window.advancedPressureViz = new AdvancedPressureVisualization();
        window.enhancedTranslations = new EnhancedTranslationSystem();
        window.roleMenuManager = new RoleMenuManager();
        console.log('üöÄ Advanced Systems Initialized');
    });

</script>

<!-- Modular architecture: utils ‚Üí auth ‚Üí menu ‚Üí i18n ‚Üí router ‚Üí keyboard ‚Üí app ‚Üí ui-tester ‚Üí Vue.js -->
</body>
</html>
